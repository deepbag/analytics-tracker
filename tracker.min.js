(()=>{let e={serverUrl:"ws://localhost:8000",batchInterval:5e3},n,o=[],s=null,i={},t=()=>{s?((n=new WebSocket(e.serverUrl)).onopen=()=>{console.log("[Analytics] Connected to server"),a()},n.onmessage=e=>{console.log("[Analytics] Server Response:",e.data)},n.onerror=e=>{console.error("[Analytics] WebSocket error:",e)},n.onclose=()=>{console.warn("[Analytics] Connection closed, retrying..."),setTimeout(t,3e3)}):console.warn("[Analytics] Website ID is required. Tracking is disabled.")},r=(e,t={})=>{s?(e={domain:window.location.hostname,url:window.location.href,timestamp:(new Date).toISOString(),referrer:document.referrer||null,eventType:e,properties:{...t,...i},websiteId:s},o.push(e),console.log("ðŸ“© Queued Event:",JSON.stringify(e)),n&&n.readyState===WebSocket.OPEN&&(console.log("ðŸš€ Sending event immediately..."),a())):console.warn("[Analytics] Website ID is required. Event tracking is disabled.")},a=()=>{if(s&&0!==o.length&&n&&n.readyState===WebSocket.OPEN)try{n.send(JSON.stringify(o)),console.log("[Analytics] Sent:",o.length,"events"),o=[]}catch(e){console.error("[Analytics] Failed to send events:",e)}};setInterval(a,e.batchInterval),window.track=(e,t)=>r(e,t),window.trackWebsiteSession=async e=>{if(e)return s=e,await(async()=>{try{var e=await(await fetch("http://ip-api.com/json")).json();i={country:e.country,region:e.regionName,city:e.city,lat:e.lat,lon:e.lon,timezone:e.timezone,isp:e.isp},console.log("[Analytics] Location fetched:",i)}catch(e){console.warn("[Analytics] Failed to fetch location:",e)}})(),t(),r("session_start",{websiteId:e}),new Promise(e=>{let t=setInterval(()=>{n&&n.readyState===WebSocket.OPEN&&(clearInterval(t),e())},100)});console.warn("[Analytics] Invalid website ID. Tracking is disabled.")}})();