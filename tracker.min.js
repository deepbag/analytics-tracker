(()=>{let e={serverUrl:"ws://localhost:9000",batchInterval:5e3},t,s=[],o=null,n=()=>{o?((t=new WebSocket(e.serverUrl)).onopen=()=>{console.log("[Analytics] Connected to server"),r()},t.onmessage=e=>{console.log("[Analytics] Server Response:",e.data)},t.onerror=e=>{console.error("[Analytics] WebSocket error:",e)},t.onclose=()=>{console.warn("[Analytics] Connection closed, retrying..."),setTimeout(n,3e3)}):console.warn("[Analytics] Website ID is required. Tracking is disabled.")},i=(e,n={})=>{o?(e={domain:window.location.hostname,url:window.location.href,timestamp:(new Date).toISOString(),referrer:document.referrer||null,eventType:e,properties:n,websiteId:o},s.push(e),console.log("ðŸ“© Queued Event:",JSON.stringify(e)),t&&t.readyState===WebSocket.OPEN&&(console.log("ðŸš€ Sending event immediately..."),r())):console.warn("[Analytics] Website ID is required. Event tracking is disabled.")},r=()=>{if(o&&0!==s.length&&t&&t.readyState===WebSocket.OPEN)try{t.send(JSON.stringify(s)),console.log("[Analytics] Sent:",s.length,"events"),s=[]}catch(e){console.error("[Analytics] Failed to send events:",e)}};setInterval(r,e.batchInterval),window.track=(e,n)=>i(e,n),window.trackWebsiteSession=e=>{e?(o=e,n(),i("session_start",{websiteId:e}),window.addEventListener("beforeunload",()=>{i("session_stop",{websiteId:e}),r()}),document.addEventListener("visibilitychange",()=>{document.hidden&&(i("session_stop",{websiteId:e}),r())})):console.warn("[Analytics] Invalid website ID. Tracking is disabled.")}})();