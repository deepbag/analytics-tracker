(()=>{let e={serverUrl:"ws://localhost:9000",batchInterval:5e3},n,t=[],o=()=>{(n=new WebSocket(e.serverUrl)).onopen=()=>{console.log("[Analytics] Connected to server"),l()},n.onmessage=e=>{console.log("[Analytics] Server Response:",e.data)},n.onerror=e=>{console.error("[Analytics] WebSocket error:",e)},n.onclose=()=>{console.warn("[Analytics] Connection closed, retrying..."),setTimeout(o,3e3)}},r=(e,o={})=>{e={domain:window.location.hostname,url:window.location.href,timestamp:(new Date).toISOString(),referrer:document.referrer||null,eventType:e,properties:o};t.push(e),console.log("ðŸ“© Queued Event:",JSON.stringify(e)),n.readyState===WebSocket.OPEN&&(console.log("ðŸš€ Sending event immediately..."),l())},l=()=>{if(0!==t.length&&n.readyState===WebSocket.OPEN)try{n.send(JSON.stringify(t)),console.log("[Analytics] Sent:",t.length,"events"),t=[]}catch(e){console.error("[Analytics] Failed to send events:",e)}};setInterval(l,e.batchInterval),o(),r("pageview"),window.track=(e,o)=>r(e,o)})();